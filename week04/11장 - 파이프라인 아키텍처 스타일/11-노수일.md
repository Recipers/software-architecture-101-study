# 11. 파이프라인 아키텍처 스타일
- 파이프라인 아키텍처(파이프와 필터 아키텍처)
    - 기본적인 아키텍처 스타일
    - 기능을 개별 파트로 분리하기로 결정하는 순간부터 이 패턴이 수반됨
    - Bash, Zsh 같은 유닉스 터미널 쉘 언어의 기초 원리
- 함수형 언어 구조와 아키텍처 요소가 유사함
- 맵리듀스 프로그래밍 모델을 응용한 많은 도구가 이 기본 토폴로지를 따름
- 저수준에서 구현할 수도 있고 고수준의 비즈니스 애플리케이션에도 적용할 수 있음
## 11.1 토폴로지
- 다수의 파이프와 필터로 구성됨
- 파이프와 필터는 특정한 방식으로 조정되며, 필터 간 단방향 통신은 점대점 방식으로 구성
### 11.1.1 파이프
    - 파이프는 한 소스에서 입력을 받아 다른 소스로 출력을 내는, 필터 간 통신 채널
    - 성능상 이유로 단방향, 점대점 방식으로 구성함
    - 파이프를 오가는 페이로드의 데이터는 어떤 포맷이라도 가능하지만, 고성능에 유리한 적은 양의 데이터를 선호함
### 11.1.2 필터
    - 필터는 자기 완비형이고, 다른 필터와 독립적이며, 일반적으로 무상태성
    - 필터는 한 가지 태스크만 수행하므로 복합 태스크는 여러 필터를 이어 붙여 처리하면 됨
#### 프로듀서
    - 프로세스의 시작점
    - 아웃바운드만 있어서 소스라고도 함
#### 변환기
    - 입력을 받아 필요시 일부 또는 전체 데이터를 변환한 후, 결과를 아웃바운드 파이프로 전달함
    - 함수형 프로그래밍의 맵
#### 테스터
    - 입력을 받아 하나 이상의 기준에 대해 테스트를 하고 그 결과에 따라 필요시 결과를 생산
    - 함수형 프로그래밍의 리듀스
#### 컨슈머
    - 파이프라인 흐름의 종착역
    - 프로세스의 최종 결과를 데이터베이스에 저장하거나 유저 인터페이스 화면에 표시
- 각 파이프와 필터는 단방향이고 워낙 단순해서 얼마든지 조합할 수 있음
## 11.2 예제
- 다양한 애플리케이션, 간단한 단방향 처리 태스크에서 흔히 찾아볼 수 있음
    - 전자 데이터 교환 (EDI) 도구
    - ETL 도구 - 다른 데이터베이스나 데이터소스로 데이터를 변환하여 흘릴 때
    - 아파치 카멜과 같은 오케스트레이터와 중재자
- 텔레메트리(원격 계측) 정보를 카프카에 스트리밍하는 예제
    - 서비스 정보 캡처(프로듀서) 필터는 카프카 토픽을 구독하여 서비스 정보를 받아 지속시간 필터에 보냄
    - 필터마다 관심사도 분리되어 있음
    - 서비스 정보 필터는 카프카 토픽에 연결하는 일만 신경 씀
    - 지속 시간 필터는 데이터 검증 후 필요시 다음 파이프에 보내는 작업만 함
    - 데이터가 지속 시간과 관련 있으면 지속 시간 계산기, 없으면 가동 시간 필터로 보내 가동 시간 필터와 관련 있는지 확인
    - 가동 시간 메트릭과 관련이 없으면 쓸모 없으므로 파이프라인 종료
    - 수정된 데이터를 출력 컨슈머로 보내 몽고DB에 저장
- 파이프라인 아키텍처의 확장성을 잘 나타냄
- 새로 수집된 메트릭을 데이터베이스에 전달하려면 가동 시간 필터 다음에 테스트 필터를 하나 더 추가
## 11.3 아키텍처 특성 등급
- 파이프라인 아키텍처 스타일은 애플리케이션 로직을 필터 타입에 따라 나누는, 기술 분할 아키텍처
- 모놀리식 형태로 구현/배포하므로 아키텍처 퀀텀은 언제나 1임
- 모듈성과 결부된 전체 비용 및 단순성이 주요 강점
- 모놀리식에 가깝기 때문에 분산 아키텍처 스타일에 수반되는 복잡도가 없음
- 단순해서 알기 쉽고 구축 및 유지보수 비용도 적게 듬
- 다양한 필터 타입과 변환기 간의 관심사를 분리함으로써 아키텍처 모듈성을 확보할 수 있고 필터를 교체/수정하더라도 다른 필터에는 아무런 영향도 미치지 않음
- 평균 수준으로 매긴 배포성 시험성은 필터를 통한 모듈성이 더 우수하므로 레이어드 아키텍처 스타일보다는 조금 나음
- 모놀리스라서 절차, 리스크, 배포 빈도, 테스트 완성도의 영향을 받음
- 레이어드 아키텍처와 마찬가지로 분산 아키텍처에서 자주 목격되는 네트워크 트래픽, 대역폭 부족, 레이턴시 탓에 전체 신뢰성은 중간
- 모놀리식 배포 특유의 고질적인 문제점 탓에 시험성 배포성, 신뢰성 중간
- 탄력성과 확장성은 모놀리식 배포 때문에 점수가 낮음
- 내고장성도 별로임
