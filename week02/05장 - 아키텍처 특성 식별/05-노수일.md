# 5. 아키텍처 특성 식별
- 아키텍처를 구축하거나 기존 아키텍처의 타당성으 검증할 때 제일 먼저 해야할 일은 아키텍처 특성을 식별하는 것
- 주어진 문제영역, 애플리케이션에서 아키텍처 특성을 정확하게 식별하기 위해서는 도메인을 잘 이해하고 있어야 함
- 도메인 이해관계자들과 혐력하여 도메인 관점에서 정말 중요한 것들을 결정해야 함
- 도메인 관심사, 요구사항, 암묵적 도메인 지식
## 5.1 도메인 관심사에서 아키텍처 특성 도출
- 아키텍트는 도메인 관심사를 올바르게 해석하여 정확한 아키텍처 특성을 식별해야 함
- 도메인 핵심목표와 현재 상황을 고려하여 도메인 관심사를 '~성'으로 해석한 후, 그에 따라 정확하고 합리적인 아키텍처 결정을 내려야 함
- 아키텍처 특성 정의 시, 최종 목록을 가능한 한 짧게 하는 것이 팁
- 가장 흔한 안티패턴 중 하나가 모든 아키텍처 특성을 지원하는 제네릭 아키텍처를 설계하려 하는 것
    - 지원가능한 아키텍처 특성 하나하나가 전체 시스템 설계를 복잡하게 만드는 요인
    - 아키텍처 특성의 개수에 연연하지 말고 가급적 설계를 단순화하는게 좋음
- 일반적으로 아키텍트와 도메인 이해관계자는 시스템이나 애플리케이션이 지원해야 할 아키텍처 특성 최종 목록에 우선 순위를 두는 경향이 있음
    - 틀린것은 아니지만, 시간낭비만 하고, 주요 담당자들과 의견이 맞지 않아 불필요한 갈등만 쌓이기 일쑤임
    - 모든 아키텍처 특성의 우선 순위에 만장일치로 의견이 모아지는 경우는 거의 없음
    - 가장 중요한 특성 3개를 뽑는 것이 좋은 방법 (무작위)
- 대부분의 아키텍처 특성은 핵심 도메인 이해관계자들의 의견을 듣고 도메인 관점에서 무엇이 중요한지 의견을 교환하면서 정리됨
    - 아키텍트와 도메인 이해관계자들이 서로 다른 언어로 말을 한다는 것이 문제
    - 아키텍트는 확장성, 상호운용성, 내고장성, 학습성, 가용성을 운운
    - 도메인 이해관계자는 인수 병합, 고객 만족, 출시 시점, 경쟁 우위를 노함
- 도메인 관심사를 아키텍처 특성으로 옮김
    |도메인 관심사|아키텍처 특성|
    |------|---|
    |인수합병|상호운용성, 확장성, 적응성, 신장성|
    |출시 시기|민첩성, 시험성, 배포성|
    |유저 만족|성능, 가용성, 내고장성, 시험성, 배포성, 민첩성, 보안|
    |경쟁 우위|민첩성, 시험성, 배포성, 확장성, 가용성, 내고장성|
    |시간 및 예산|단순성, 실행성|
- 민첩성이 곧 출시 시기를 의미 하는 것은 아님
- 출시 시기가 민첩성 + 시험성 + 배포성
- 무능한 아키텍트는 성능이 도메인 관심사의 정점인 양 오로지 성능에 집중, 몇 가지 이유로 실패함
    - 필요한 시점에 시스템을 사용할 수 없다면 얼마나 빠른지는 중요하지 않음
    - 도메인이 커지고 펀드가 많이 유입되면 제시간에 종가 계산을 마칠 수 있도록 시스템 규모를 확장할 수 있어야 함
    - 시스템은 가용성과 더불어 펀드 종가 계산 도중 시스템이 멎는 불상사가 생기지 않도록 안정성도 보장되어야 함
    - 펀드 종가 계산이 약 85% 완료된 상태에서 시스템이 다운되면? 즉시 시스템을 복구해서 가장 마지막에 펀드 종가가 계산된 시점부터 다시 실행해야 함
    - 시스템은 빠른 것도 중요하지만 펀드 종가는 정확하게 계산되어야 함
## 5.2 요구사항에서 아키텍처 특성 도출
- 요구사항 정의서에 명시된 문장에서 도출한 아키텍처 특성도 있음
    - ex : 유저 수와 그에 따른 확장 문제
- 아키텍트가 알고 있는 도메인 지식에서 도출되는 특성들도 있음
    - ex 수강등록 애플리케이션
        - 총 학생 수 : 1,000명
        - 학생 1인 당 10시간의 수강 신청
        - 학생들의 시스템 이용 시간이 고루 분산되는 전제 vs 마감 10분전부터 1,000명의 학생 모두가 달려들어도 문제없는 시스템 설계
## 5.3 사례 연구 : 실리콘 샌드위치
- 실리콘 샌드위치 카타를 예로 들어 아키텍트가 요구사항을 바탕으로 아키텍처 특성을 도출하는 방법
>#### 설명
>- 실리콘 샌드위치는 전국 가맹점을 보유한 샌드위치 브랜드로, 온라인 주문 시스템을 구축하려 함
>#### 유저
>- 앞으로 수천 명, 어쩌면 수백만 명에 달할 지도 모름
>#### 요구사항
>- 유저가 주문을 하면 샌드위치를 픽업하러 갈 시간 및 상점까지 가는 경로를 전달 받음
>    - 교통정보가 포함된 여러 외부 지도 서비스와의 연계 필수
>- 배달 서비스가 가능한 지점은 기사를 보내 샌드위치를 유저에게 배달
>- 모바일 기기 이용 가능
>- 전국 어느 지점이나 이용 가능한 프로모션/스페셜 행사 제공
>- 특점 지점에서만 이용 가능한 로컬 프로모션/스페셜 행사 제공
>- 온라인 결제, 대면 결제, 배송 시 결제 등 다양한 결제 옵션 제공
>#### 부가 콘텍스트
>- 샌드위치 지점은 가맹점이므로 소유자가 다 다름
>- 모회사는 머지않아 해외 시장도 진출할 계획
>- 이 회사는 값싼 인력을 고용해 이윤을 최대하하는 것이 목표

- 아키텍트는 전체 시스템을 코드 레벨로 설계하는 것이 아님
- 구조와 관련이 있거나 영향을 미치는 것들을 찾아내는 것이 임무
- 명시적인 것과 암묵적인 것으로 구분
### 5.3.1 명시적 특성
- 명시적 아키텍처 특성을 설계의 일부로서 요구사항 정의서에 기술됨
- 도메인 레벨에서의 기대치를 먼저 고려해야 함
- 가장 먼저 눈 여겨 봐야 할 부분은 유저 수
    - 수천 ~ 향후 수백만명
    - 확장성, 유의미한 성능 저하 없이 다수의 동시 유저를 처리하는 능력이 중요해 보임
    - 확장성이 요구사항에 명시된 것은 아니지만, 명시된것이나 다름 없음
    - 도메인 언어를 엔지니어링 언어로 해독해야 함
- 순간적으로 폭증한 유저 요청을 처리하려면 탄력성도 필요함
- 확장성과 탄력성은 한몸처럼 나타날 때도 많지만 제약조건은 각각 다름
    - 호텔 예약 시스템 : 투숙객 수는 대체로 일정
    - 티켓 예약 시스템 : 티켓 발매가 시작되면 왕창 몰려듬
    - 탄력성이 필수라는 문구는 요구사항에 없지만, 중요한 고려 사항으로 식별해야 함

>- 유저가 주문을 하면 샌드위치를 픽업하러 갈 시간 및 상점까지 가는 경로를 전달 받음 (외부 지도 연계 서비스 필수)
>    - 외부 지도 서비스는 곧 연계 지점
>    - 신뢰성과 같은 특성에 영향을 미침
>    - 외부 지도 서비스가 다운 된다면
>        - 사이트 전체가 멎어야 하나
>        - 교통 정보가 빠진 서비스로 제공되어야 하나
>    - 불필요한 불안정성 또는 취약점이 설계에 반영되지 않도록 항상 조심해야 함
>- 배달 서비스가 가능한 지점은 기사를 보내 샌드위치를 유저에게 배달
>    - 아키텍처 특성 필요하지 않음
>- 모바일 기기 이용 가능
>    - 이식성 좋은 웹 애플리케이션과 다양한 네이티브 웹 애플리케이션 중 어느 쪽으로 개발할 것인가
>    - 독단적인 판단보단 UX 설계자, 도메인 담당자, 기타 도메인 이해관계자들과 충분한 협의
>- 전국 어느 지점이나 이용 가능한 프로모션/스페셜 행사 제공
>- 특점 지점에서만 이용 가능한 로컬 프로모션/스페셜 행사 제공
>    - 스페셜 행사에 관한 커스터마이징 기능, 1번 요구사항이 유저 주소에 맞는 교통정보의 커스터마이징을 의미
>    - 세 요구사항을 토대로 맞춤성을 아키텍처 특성으로 도출할 수 있음
>    - 기본 동작을 코어에 두고 개발자가 선택적으로 플러그인을 통해 위치 기반의 커스터마이징한 로직을 작성할 수 있음
>    - 기존 설계 패턴 (ex : 템플릿 메서드)을 이용해도 구현 가능
>- 온라인 결제, 대면 결제, 배송 시 결제 등 다양한 결제 옵션 제공
>    - 보안, 어느 정도의 보안이 필요한지는 파악 불가
>- 샌드위치 지점은 가맹점이므로 소유자가 다 다름
>    - 아키텍처 비용에 제약
>    - 단순하거나 기능이 조금 빠진 아키텍처로도 충분한지 타당성을 미리 확인
>- 모회사는 머지않아 해외 시장도 진출할 계획
>    - 국제화, i18n이 필요
>- 이 회사는 값싼 인력을 고용해 이윤을 최대하하는 것이 목표
>    - 사용성이 중요하지만, 아키텍처 특성보다는 설계와 더 깊은 연관이 있음
- 요구사항 정의서에서 도출한 세 번째 아키텍처 특성은 성능
- 성능은 미묘한 뉘앙스가 함축된 개념
- 확장성 수와 성능 수도 함께 정의하는게 좋음
- 성능의 기준선을 먼저 그어 놓고 특성 수의 유저가 접속할 때 성능은 어느 정도가 나와야 수용 가능한지 정해야 함
### 5.3.2 암묵적 특성
- 요구사항 정의서에 없는 아키텍처 특성도 있지만 이들은 각각 중요한 설계 요소가 됨
- 가용성은 시스템에서 마땅히 지원되어야 할 암묵적인 아키텍처 특성
- 시스템을 문제없이 사용하기 위한 신뢰성도 반드시 필요
- 보안은 모든 시스템에 공통적인 암묵적 특성
- 아키텍처 특성은 서로 연관되어 움직이므로 중요도에 따라 우선순위는 달라질 수 있음
- 어느 한 아키텍처 특성을 지나치게 적용하면, 시스템이 너무 복잡하게 설계되어 모자라게 적용하는 것만큼 해로움
- 실리콘 샌드위치의 마지막 아키텍처 특성으로는 맞춤성
    - 유저의 의도에 맞게 커스터마이징이 원할하게 지원되는 아키텍처가 필요함
    - 보통 애플리케이션의 설계 범주에 속함
    - 커스터마이징한 구조에 의존하는 문제 영역은 아키텍처 특성의 영역으로 옮김
- 아키텍처에서는 틀린 답은 없고 값비싼 답만 있음
- 아키텍처에서 최고의 설계는 없고, 오직 나쁜 것 중에서 제일 나은 트레이드오프들만 있을 뿐
- 아키텍트는 아키텍처 특성에 우선순위를 매겨 가장 단순한 필수 세트로 정리해야 함
- 가장 덜 중요한 것을 솎아내는 훈련도 도움이 됨
- 암묵적 특성은 대부분 일반적인 성공을 지원하기 때문에 일반적으로 명시적 아키텍처 특성을 추려낼 가능성이 높음